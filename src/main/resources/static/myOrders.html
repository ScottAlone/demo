<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Itinerary</title>
</head>
    <link href="styles/bootstrap.css" rel="stylesheet">
    <link href="styles/common.css" rel="stylesheet">
    <link href="styles/animate.css" rel="stylesheet">
    <link href="styles/style.css" rel="stylesheet">
<body class="pace-done">
<div id="app-wrapper">
    <nav class="navbar-default navbar-static-side" role="navigation">
        <div class="sidebar-collapse">
            <div class="nav-header menu-center">
                <img alt="image" class="profile-img" src="img/pic.jpg">
            </div>
            <li class="menu-center">
                <p> username:&nbsp XXDR </p>
                <p> role: &nbsp GUIDE</p>
            </li>

            <ul class="nav metismenu" id="side-menu">
                <li class="landing_link">
                    <a href="main.html">★<span class="nav-label">&nbsp&nbsp&nbsp MAIN</span> <span class="label label-warning pull-right">NEW</span></a>
                </li>
                <li class="landing_link">
                    <a href="journey.html">★<span class="nav-label">&nbsp&nbsp&nbsp JOURNEY</span></a>
                </li>
                <li class="landing_link">
                    <a href="myProfile.html">★<span class="nav-label">&nbsp&nbsp&nbsp PROFILE</span> <span class="label label-warning pull-right">LV_1</span></a>
                </li>
                <li class="landing_link">
                    <a href="myOrders.html">★<span class="nav-label">&nbsp&nbsp&nbsp ORDERS</span> <span class="label label-warning pull-right">LV_1</span></a>
                </li>
            </ul>
        </div>
    </nav>
    <div id="page-wrapper" class="white-bg" style="min-height: 700px">
        <div class="roll">
            <div class="col-lg-4">
                <div class="ibox">
                    <div class="ibox-content">
                        <h3 style="text-align: center">FUTURE</h3>
                        <ul class="sortable-list agile-list ui-sortable" id="toAccept" style="max-height: 600px; overflow-y: auto">
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-lg-4">
            <div class="ibox">
                <div class="ibox-content">
                    <h3 style="text-align: center">UNDERWAY</h3>
                    <ul class="sortable-list agile-list ui-sortable" id="accepted" style="max-height: 600px; overflow-y: auto">
                    </ul>
                </div>
            </div>
        </div>

        <div class="col-lg-4">
            <div class="ibox">
                <div class="ibox-content">
                    <h3 style="text-align: center">FINISHED</h3>
                    <ul class="sortable-list agile-list ui-sortable" id="finished" style="max-height: 600px; overflow-y: auto">
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="js/jquery.js"></script>
<script src="js/bootstrap.min.js"></script>
<script src="js/main.js"></script>
<script>
function changeToAccept(button) {
    button.text = "ACCEPTED";
    button.setAttribute("disabled", "disabled");
}

function contains(arr, obj) {
    var i = arr.length;
    while (i--) {
        if (arr[i] === obj) {
            return true;
        }
    }
    return false;
}

window.onload = function () {
    let t1 = "Sightseeing tour";
    let t2 = "Business tour";
    let t3 = "Holiday tour";
    var journeyIds = [];
    $.ajax({
        url: "/orders/" + "customer" + "/status?" + "cUsername=" + "x" + "&status=" + "0" ,
        type: 'GET',
        context: document.body,
        success: function(data, statusText, xhr){
            if (data.code == 200){
                let journey = data.data;
                for (let i = 0; i < journey.length; i++){
                    journeyIds.push(data.data[i].journeyId)
                }
            }
        }
    });

    $.ajax({
        url: "journeys/city?cityName=" + "万洲区" ,
        type: 'GET',
        context: document.body,
        success: function(data, statusText, xhr){
            if (data.code == 200){
                var orders = data.data;
            }
            for (let i = 0; i < orders.length; i++){
                if (journeyIds.length >= 1 && contains(journeyIds, orders[i].journeyId)){
                    let ele = $("<li class='warning-element' id=\'toa" + i + "\'></li>");
                    let dest = $("<p></p>").text("Destination:  " + orders[i].cityName);
                    let type = $("<p></p>").text("Type:  " + ((orders[i].tourType == 1)?t1:(orders[i].tourType == 2)?t2:t3));
                    let tags = $("<p></p>").text("Tags:  " + orders[i].tags);
                    let duration = $("<div class='agile-detail'></div>");
                    let button = $("<a class='pull-right btn btn-xs btn-primary' onclick='changeToAccept(this)'></a>").text("YES");
                    duration.text("Price:  " + orders[i].price + "RMB");
                    ele.append(dest).append(type).append(tags).append(duration);
                    $("#toAccept").append(ele);
                    duration.append(button);
                }
            }
        }
    });

    $.ajax({
        url: "/orders/" + "customer" + "/status?" + "cUsername=" + "x" + "&status=" + "2" ,
        type: 'GET',
        context: document.body,
        success: function(data, statusText, xhr){
            if (data.code == 200){
                var orders = data.data;
            }
            for (let i = 0; i < orders.length; i++){
                let ele = $("<li class='info-element' id=\'acc" + i + "\'></li>");
                let dest = $("<p></p>").text("Destination:  ");
                let type = $("<p></p>").text("Type:  ");
                let tags = $("<p></p>").text("Tags:  ");
                let duration = $("<div class='agile-detail'></div>");
                duration.text("Price:  " + orders[i].price + "RMB");
                ele.append(dest).append(type).append(tags).append(duration);
                $("#accepted").append(ele);
            }
        }
    });

    $.ajax({
        url: "/orders/" + "customer" + "/status?" + "cUsername=" + "x" + "&status=" + "3" ,
        type: 'GET',
        context: document.body,
        success: function(data, statusText, xhr){
            if (data.code == 200){
                var orders = data.data;
            }
            for (let i = 0; i < orders.length; i++){
                let ele = $("<li class='success-element' id=\'fin" + i + "\'></li>");
                let dest = $("<p></p>").text("Destination:  ");
                let type = $("<p></p>").text("Type:  ");
                let tags = $("<p></p>").text("Tags:  ");
                let duration = $("<div class='agile-detail'></div>");
                duration.text("Price:  " + orders[i].price + "RMB");
                ele.append(dest).append(type).append(tags).append(duration);
                $("#finished").append(ele);
            }
        }
    });
}
</script>
</body>
</html>
